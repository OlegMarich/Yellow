<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Banana Reports ‚Äî Scanner</title>

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://unpkg.com/@zxing/library@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body data-mode="scanner">
  <div class="page page--scanner">

    <header class="page__header"></header>

    <section class="page__section">
      <div class="container">

        <!-- QR connection -->
        <div class="scanner-qr">
          <h3 class="scanner-qr__title">üì± Phone Connection</h3>
          <p class="scanner-qr__description">
            Scan the QR code or tap the button to open the scanner in your phone‚Äôs browser.
          </p>

          <div class="scanner-qr__box">
            <div id="qrBox" class="scanner-qr__code"></div>
            <div id="qrStatus" class="scanner-qr__status"></div>
          </div>
        </div>

        <!-- Main scanner -->
        <div class="scanner">

          <h2 class="section__title">üì¶ Scanner</h2>

          <label class="form__label">
            Date:
            <input type="date" id="scanDate" class="input">
          </label>

          <button id="loadOrders" class="button button--primary button--full">
            Load Orders
          </button>

          <label class="form__label">
            Client:
            <select id="clientSelect" class="select">
              <option value="">‚Äî select a client ‚Äî</option>
            </select>
          </label>

          <div id="orderStatus" class="order-status"></div>

          <label class="form__label">
            Pallet Type:
            <select id="palletType" class="select">
              <option value="EURO PALLETS">Euro (4 columns)</option>
              <option value="IND. PALLETS">Industrial (6 columns)</option>
              <option value="PHP mini">PHP mini (2 columns)</option>
            </select>
          </label>

          <label class="form__label">
            Boxes per pallet:
            <input type="number" id="palletHeight" class="input" inputmode="numeric">
          </label>

          <label class="form__label">
            Mode:
            <select id="scanMode" class="select">
              <option value="auto">AUTO ‚Äî fast scanning</option>
              <option value="manual">MANUAL ‚Äî manual counter</option>
            </select>
          </label>

          <label class="form__label">
            Number of rows:
            <input type="number" id="rowsCount" class="input" value="1" inputmode="numeric">
          </label>

          <div id="rowCheck" class="scanner__info"></div>

          <div class="pallet-sides">
            <label class="form__label">
              Side 1:
              <input type="number" id="side1" class="input side-input" value="0" inputmode="numeric">
            </label>

            <label class="form__label">
              Side 2:
              <input type="number" id="side2" class="input side-input" value="0" inputmode="numeric">
            </label>
          </div>

          <div id="palletCheck" class="scanner__info"></div>

          <label class="form__label">Container scan:</label>

          <button id="startVideoScanner" class="button button--primary button--full">
            üé• Enable Video Scanner
          </button>

          <div id="cameraStatus" class="scanner__info"></div>

          <video id="videoScanner" class="video-scanner" autoplay playsinline muted></video>

          <button id="cameraScanBtn" class="button button--primary button--big button--full">
            üì∑ Scan Photo
          </button>
          <input type="file" id="cameraInput" accept="image/*" capture="environment" hidden>

          <img id="preview" class="scanner__preview">

          <input type="text" id="scanInput" class="input" placeholder="Scanned number..." autocomplete="off">

          <label class="form__label">
            Quantity:
            <div class="qty">
              <input type="number" id="qtyInput" class="input qty__input" value="1" inputmode="numeric">
              <button id="manualPlusBtn" class="button button--primary qty__plus" type="button">+</button>
            </div>
          </label>

          <div class="section__actions">
            <button id="finishBtn" class="button button--primary button--full">Finish Client</button>
            <button id="undoBtn" class="button button--secondary button--full">‚Ü©Ô∏è Undo</button>
          </div>

          <div id="log" class="scanner__log"></div>

          <!-- Modal keypad -->
          <div id="manualKeyboard" class="modal-keypad">
            <div class="modal-keypad__content">

              <div class="modal-keypad__title">Add quantity:</div>

              <input id="manualQty" type="text" class="modal-keypad__input" readonly>

              <div class="modal-keypad__grid">
                <button class="modal-keypad__key" onclick="window.numPress(1)">1</button>
                <button class="modal-keypad__key" onclick="window.numPress(2)">2</button>
                <button class="modal-keypad__key" onclick="window.numPress(3)">3</button>

                <button class="modal-keypad__key" onclick="window.numPress(4)">4</button>
                <button class="modal-keypad__key" onclick="window.numPress(5)">5</button>
                <button class="modal-keypad__key" onclick="window.numPress(6)">6</button>

                <button class="modal-keypad__key" onclick="window.numPress(7)">7</button>
                <button class="modal-keypad__key" onclick="window.numPress(8)">8</button>
                <button class="modal-keypad__key" onclick="window.numPress(9)">9</button>

                <button class="modal-keypad__key" onclick="window.backspaceQty()">‚Üê</button>
                <button class="modal-keypad__key" onclick="window.numPress(0)">0</button>
                <button class="modal-keypad__key" onclick="window.clearQty()">‚åß</button>
              </div>

              <div class="modal-keypad__actions">
                <button class="modal-keypad__btn button--primary" onclick="window.confirmManualQty()">OK</button>
                <button class="modal-keypad__btn button--secondary"
                  onclick="window.closeManualKeyboard()">Cancel</button>
              </div>

            </div>
          </div>

          <div class="section__actions">
            <a href="/index.html" class="button button--secondary button--full">‚Üê Back to Home</a>
          </div>

        </div>

      </div>
    </section>

    <footer class="page__footer"></footer>
  </div>

  <script type="module" src="/js/scanner.js"></script>
</body>

</html>